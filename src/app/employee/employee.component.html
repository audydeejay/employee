<div class="container mt-4">
  <div
    class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2"
  >
    <h3>Employee List</h3>
    <button class="btn btn-success" routerLink="/add">Add Employee</button>
  </div>

  <!-- Search -->
  <div class="row g-2 mb-3">
    <div class="col-sm-6 col-md-4">
      <input
        type="text"
        class="form-control"
        placeholder="Search Username"
        [(ngModel)]="searchUsername"
        (ngModelChange)="onSearchChange()"
      />
    </div>
    <div class="col-sm-6 col-md-4">
      <input
        type="text"
        class="form-control"
        placeholder="Search First Name"
        [(ngModel)]="searchFirstName"
        (ngModelChange)="onSearchChange()"
      />
    </div>

    <div class="col-sm-6 col-md-4">
      <select
        class="form-select"
        [(ngModel)]="pageSize"
        (change)="changePageSize(pageSize)"
      >
        <option *ngFor="let size of pageSizes" [value]="size">
          {{ size }} per page
        </option>
      </select>
    </div>
  </div>

  <!-- Table -->
  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-light">
        <tr>
          <th (click)="changeSort('username')" style="cursor: pointer">
            Username
            <span *ngIf="sortColumn === 'username'">
              <i *ngIf="sortDirection === 'asc'" class="bi bi-arrow-up"></i>
              <i *ngIf="sortDirection === 'desc'" class="bi bi-arrow-down"></i>
            </span>
          </th>
          <th (click)="changeSort('firstName')" style="cursor: pointer">
            First Name
            <span *ngIf="sortColumn === 'firstName'">
              <i *ngIf="sortDirection === 'asc'" class="bi bi-arrow-up"></i>
              <i *ngIf="sortDirection === 'desc'" class="bi bi-arrow-down"></i>
            </span>
          </th>
          <th>Last Name</th>
          <th>Email</th>
          <th>Birth Date</th>
          <th>Basic Salary</th>
          <th>Status</th>
          <th>Group</th>
          <th>Description</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let emp of pagedEmployees">
          <td>{{ emp.username }}</td>
          <td>{{ emp.firstName }}</td>
          <td>{{ emp.lastName }}</td>
          <td>{{ emp.email }}</td>
          <td>{{ emp.birthDate | date : "yyyy-MM-dd" }}</td>
          <td>{{ emp.basicSalary | currency : "RP " }}</td>
          <td>{{ emp.status }}</td>
          <td>{{ emp.group }}</td>
          <td>{{ emp.description | date : "yyyy-MM-dd" }}</td>
          <td>
            <button
              class="btn btn-warning btn-sm action-btn"
              (click)="onEdit(emp)"
            >
              Edit
            </button>
            <button
              class="btn btn-danger btn-sm action-btn"
              (click)="onDelete(emp)"
            >
              Delete
            </button>
            <button class="btn btn-primary btn-sm action-btn" (click)="goToDetail(emp)">
              Detail
            </button>
          </td>
        </tr>
        <tr *ngIf="pagedEmployees.length === 0">
          <td colspan="10" class="text-center">No employees found.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Paging -->
  <nav aria-label="Page navigation" class="mt-3">
    <ul class="pagination justify-content-center flex-wrap">
      <li class="page-item" [class.disabled]="page === 1">
        <a
          class="page-link"
          href="#"
          (click)="changePage(page - 1); $event.preventDefault()"
          >Previous</a
        >
      </li>

      <li
        *ngFor="let p of [].constructor(totalPages); let i = index"
        class="page-item"
        [class.active]="page === i + 1"
      >
        <a
          class="page-link"
          href="#"
          (click)="changePage(i + 1); $event.preventDefault()"
          >{{ i + 1 }}</a
        >
      </li>

      <li class="page-item" [class.disabled]="page === totalPages">
        <a
          class="page-link"
          href="#"
          (click)="changePage(page + 1); $event.preventDefault()"
          >Next</a
        >
      </li>
    </ul>
  </nav>

  <!-- Notif -->
  <div
    *ngIf="notification"
    class="notification"
    [ngClass]="{
      edit: notificationType === 'edit',
      delete: notificationType === 'delete'
    }"
  >
    {{ notification }}
  </div>
</div>
